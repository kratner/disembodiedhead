<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Disembodied Head</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        background-color: black;
        color: white;
        font-family: Arial, sans-serif;
        overflow: hidden;
      }
      #logo-container {
        position: absolute;
        bottom: 33%;
        left: 0;
        width: 100%;
        height: 50vh;
        overflow: hidden;
      }
      #logo {
        height: 100%;
        width: auto;
        position: absolute;
        left: calc(-1 * var(--logo-width));
        animation: moveLogo var(--animation-duration) linear infinite;
      }
      @keyframes moveLogo {
        0% {
          transform: translateX(0);
        }
        100% {
          transform: translateX(calc(100vw + var(--logo-width)));
        }
      }
      #hanging-head {
        position: fixed;
        top: calc(-5vh - 20px); /* Moved up by 20 pixels */
        left: 50%;
        transform: translateX(-50%);
        width: 30vw;
        max-width: 300px;
        height: auto;
        animation: swing 4s ease-in-out infinite;
        transform-origin: 50% 0;
      }
      @media (orientation: portrait) {
        #hanging-head {
          width: 60vw;
          max-width: none;
        }
      }
      @keyframes swing {
        0%,
        100% {
          transform: translateX(-50%) rotate(0deg);
        }
        25% {
          transform: translateX(-50%) rotate(-5deg);
        }
        75% {
          transform: translateX(-50%) rotate(5deg);
        }
      }
      #thought-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }
      .thought-bubble {
        position: absolute;
        background-color: rgba(255, 255, 255, 0.9);
        color: black;
        padding: 20px;
        border-radius: 50px;
        max-width: 200px;
        opacity: 0;
        transition: opacity 2s ease-in-out, transform 10s linear;
      }
    </style>
  </head>
  <body>
    <div id="logo-container">
      <img
        id="logo"
        src="src/assets/logos/dh_white.svg"
        alt="The Disembodied Head"
      />
    </div>
    <img
      id="hanging-head"
      src="src/assets/images/head.svg"
      alt="Hanging Head"
    />
    <div id="thought-container"></div>
    <script>
      function updateLogoAnimation() {
        const logo = document.getElementById("logo");
        const logoWidth = logo.offsetWidth;
        const screenWidth = window.innerWidth;
        document.documentElement.style.setProperty(
          "--logo-width",
          `${logoWidth}px`
        );
        const animationDuration = (screenWidth + logoWidth) / 20;
        document.documentElement.style.setProperty(
          "--animation-duration",
          `${animationDuration}s`
        );
      }

      const thoughts = [
        "I could certainly use a stiff cocktail.",
        "Keeping it simple.",
        "I've been trying to channel my anger into something productive.",
        "Your emotions are food for my soul.",
        "Stop lookin' at me like that.",
        "My balls itch.",
      ];

      function getRandomPosition(head, isPortrait) {
        const headRect = head.getBoundingClientRect();
        const centerX = headRect.left + headRect.width / 2;
        const centerY = headRect.top + headRect.height / 2;

        let x, y;
        if (isPortrait) {
          x = 0;
          y = headRect.height + 50 + Math.random() * 50;
        } else {
          const angle = Math.random() * 2 * Math.PI;
          const distance =
            Math.random() *
            Math.min(window.innerWidth, window.innerHeight) *
            0.3;
          x = Math.cos(angle) * distance;
          y = Math.sin(angle) * distance;
        }

        return [
          centerX + x - window.innerWidth / 2,
          centerY + y - window.innerHeight / 2,
        ];
      }

      function animateThoughtBubbles() {
        const container = document.getElementById("thought-container");
        const head = document.getElementById("hanging-head");
        let currentThoughtIndex = 0;

        function showNextThought() {
          container.innerHTML = "";

          const isPortrait = window.innerHeight > window.innerWidth;
          const [x, y] = getRandomPosition(head, isPortrait);

          const thoughtBubble = document.createElement("div");
          thoughtBubble.className = "thought-bubble";
          thoughtBubble.textContent = thoughts[currentThoughtIndex];

          const messageLength = thoughts[currentThoughtIndex].length;
          const displayTime = Math.max(5000, messageLength * 100); // Minimum 5 seconds, or 100ms per character

          const direction = Math.random() < 0.5 ? -1 : 1; // -1 for left, 1 for right
          const moveDistance = 100 * direction; // 100px left or right

          thoughtBubble.style.left = `calc(50% + ${x}px)`;
          thoughtBubble.style.top = `calc(50% + ${y}px)`;

          container.appendChild(thoughtBubble);

          setTimeout(() => {
            thoughtBubble.style.opacity = "1";
            thoughtBubble.style.transform = `translateX(${moveDistance}px)`;
          }, 100);

          setTimeout(() => {
            thoughtBubble.style.opacity = "0";
          }, displayTime + 2000); // Start fading out after display time

          setTimeout(() => {
            currentThoughtIndex = (currentThoughtIndex + 1) % thoughts.length;
            showNextThought();
          }, displayTime + 4000); // Wait for fade out before showing next thought
        }

        showNextThought();
      }

      window.addEventListener("load", () => {
        updateLogoAnimation();
        animateThoughtBubbles();
      });
      window.addEventListener("resize", () => {
        updateLogoAnimation();
        animateThoughtBubbles();
      });
    </script>
  </body>
</html>
